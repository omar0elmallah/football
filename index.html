<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة كرة قدم - إصدار المحترفين</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #0a3d62;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
        }
        
        #game-container {
            position: relative;
            width: 1000px;
            height: 600px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }
        
        #game-canvas {
            background: linear-gradient(to bottom, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%);
            display: block;
        }
        
        #score-board {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 30px;
            border-radius: 20px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            z-index: 100;
        }
        
        #controls-info {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            text-align: center;
        }
        
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        
        #start-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 24px;
            border-radius: 30px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
        }
        
        #start-button:hover {
            background: #c0392b;
            transform: scale(1.05);
        }
        
        .title {
            font-size: 48px;
            margin-bottom: 20px;
            color: #f1c40f;
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.7);
        }
        
        .goal-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            z-index: 150;
            opacity: 0;
            pointer-events: none;
        }
        
        .power-bar {
            position: absolute;
            bottom: 10px;
            width: 100px;
            height: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .power-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #f1c40f, #e74c3c);
            transition: width 0.1s;
        }
        
        #player1-power {
            left: 20px;
        }
        
        #player2-power {
            right: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas" width="1000" height="600"></canvas>
        
        <div id="score-board">0 - 0</div>
        
        <div id="controls-info">
            الفريق الأزرق: الأسهم (حركة) ، مسافة (ضربة) ، Shift (تمرير) | الفريق الأحمر: WASD (حركة) ، Q (ضربة) ، E (تمرير)
        </div>
        
        <div id="player1-power" class="power-bar">
            <div class="power-fill"></div>
        </div>
        
        <div id="player2-power" class="power-bar">
            <div class="power-fill"></div>
        </div>
        
        <div id="start-screen">
            <h1 class="title">كرة القدم المحترفة</h1>
            <p>كل فريق مكون من 3 لاعبين (تتحكم في اللاعب الأساسي)</p>
            <button id="start-button">بدء المباراة</button>
        </div>
        
        <div class="goal-effect" id="goal-effect"></div>
    </div>

    <script>
        // عناصر DOM
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const scoreBoard = document.getElementById('score-board');
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const goalEffect = document.getElementById('goal-effect');
        const player1PowerFill = document.querySelector('#player1-power .power-fill');
        const player2PowerFill = document.querySelector('#player2-power .power-fill');

        // حالات اللعبة
        let gameRunning = false;
        let animationFrameId;
        let lastTime = 0;
        
        // إعدادات اللعبة
        const config = {
            playerSpeed: 5,
            aiSpeed: 3,
            ballStartSpeed: 4,
            maxBallSpeed: 18,
            powerShotMultiplier: 2.5,
            passSpeed: 8,
            attractionDistance: 100,
            attractionForce: 0.05,
            friction: 0.96,
            bounceFriction: 0.9,
            playerSize: 30,
            ballSize: 18,
            goalWidth: 150,
            postWidth: 10,
            teamSize: 3
        };
        
        // الكائنات
        const game = {
            teams: [
                { // الفريق الأزرق (أسفل)
                    color: '#3498db',
                    players: [],
                    controlledPlayer: 0,
                    score: 0,
                    controls: {
                        left: 'ArrowLeft',
                        right: 'ArrowRight',
                        up: 'ArrowUp',
                        down: 'ArrowDown',
                        kick: ' ',
                        pass: 'Shift'
                    }
                },
                { // الفريق الأحمر (أعلى)
                    color: '#e74c3c',
                    players: [],
                    controlledPlayer: 0,
                    score: 0,
                    controls: {
                        left: 'a',
                        right: 'd',
                        up: 'w',
                        down: 's',
                        kick: 'q',
                        pass: 'e'
                    }
                }
            ],
            ball: {
                x: canvas.width / 2,
                y: canvas.height / 2,
                radius: config.ballSize / 2,
                dx: 0,
                dy: 0,
                color: 'white',
                lastTouch: null
            },
            field: {
                width: canvas.width,
                height: canvas.height,
                center: {
                    x: canvas.width / 2,
                    y: canvas.height / 2
                },
                centerCircleRadius: 70,
                padding: 20
            },
            goals: [
                { // الهدف السفلي (للفريق الأحمر)
                    x: canvas.width / 2 - config.goalWidth / 2,
                    y: canvas.height - 20,
                    width: config.goalWidth,
                    height: 10,
                    color: '#e74c3c'
                },
                { // الهدف العلوي (للفريق الأزرق)
                    x: canvas.width / 2 - config.goalWidth / 2,
                    y: 10,
                    width: config.goalWidth,
                    height: 10,
                    color: '#3498db'
                }
            ],
            keys: {}
        };
        
        // تهيئة اللاعبين
        function initPlayers() {
            game.teams.forEach((team, teamIndex) => {
                team.players = [];
                
                // اللاعب الأساسي (وسط الملعب)
                team.players.push({
                    x: canvas.width / 2 - config.playerSize / 2,
                    y: teamIndex === 0 ? canvas.height - 100 : 60,
                    width: config.playerSize,
                    height: config.playerSize,
                    color: team.color,
                    speed: config.playerSpeed,
                    dx: 0,
                    dy: 0,
                    power: 0,
                    isCharging: false,
                    isControlled: true,
                    team: teamIndex
                });
                
                // لاعبين إضافيين لكل فريق
                for (let i = 1; i < config.teamSize; i++) {
                    const angle = (i / (config.teamSize - 1)) * Math.PI * 0.8 + Math.PI * 0.1;
                    const distance = 120;
                    
                    team.players.push({
                        x: canvas.width / 2 - config.playerSize / 2 + Math.cos(angle) * distance * (teamIndex === 0 ? -1 : 1),
                        y: (teamIndex === 0 ? canvas.height - 150 : 90) + Math.sin(angle) * distance,
                        width: config.playerSize,
                        height: config.playerSize,
                        color: team.color,
                        speed: config.aiSpeed,
                        dx: 0,
                        dy: 0,
                        power: 0,
                        isCharging: false,
                        isControlled: false,
                        team: teamIndex
                    });
                }
            });
        }
        
        // أحداث لوحة المفاتيح
        window.addEventListener('keydown', (e) => {
            game.keys[e.key] = true;
            
            // شحن الضربة للاعبين
            game.teams.forEach(team => {
                const player = team.players[team.controlledPlayer];
                if (e.key === team.controls.kick) {
                    player.isCharging = true;
                }
                
                // التمرير
                if (e.key === team.controls.pass) {
                    passBall(player);
                }
            });
        });
        
        window.addEventListener('keyup', (e) => {
            game.keys[e.key] = false;
            
            // تنفيذ الضربة عند ترك الزر
            game.teams.forEach(team => {
                const player = team.players[team.controlledPlayer];
                if (e.key === team.controls.kick && player.isCharging) {
                    kickBall(player);
                    player.isCharging = false;
                    player.power = 0;
                }
            });
        });
        
        // بدء اللعبة
        startButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            gameRunning = true;
            initPlayers();
            resetGame();
            animationFrameId = requestAnimationFrame(gameLoop);
        });
        
        // وظيفة الضربة
        function kickBall(player) {
            // حساب المسافة بين اللاعب والكرة
            const dx = game.ball.x - (player.x + player.width / 2);
            const dy = game.ball.y - (player.y + player.height / 2);
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            // إذا كانت الكرة قريبة من اللاعب
            if (distance < 60) {
                // حساب زاوية وقوة الضربة
                const angle = Math.atan2(dy, dx);
                const power = player.power * config.powerShotMultiplier + 2;
                
                // تطبيق القوة على الكرة
                game.ball.dx = Math.cos(angle) * power;
                game.ball.dy = Math.sin(angle) * power;
                game.ball.lastTouch = player.team;
                
                // الحد الأقصى لسرعة الكرة
                limitBallSpeed();
                
                // تأثير صوتي
                playSound('kick');
            }
        }
        
        // وظيفة التمرير
        function passBall(player) {
            // حساب المسافة بين اللاعب والكرة
            const dx = game.ball.x - (player.x + player.width / 2);
            const dy = game.ball.y - (player.y + player.height / 2);
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 60) {
                // البحث عن أقرب زميل
                let closestTeammate = null;
                let minDistance = Infinity;
                
                game.teams[player.team].players.forEach((teammate, index) => {
                    if (teammate !== player) {
                        const dist = Math.sqrt(
                            Math.pow(teammate.x + teammate.width/2 - game.ball.x, 2) + 
                            Math.pow(teammate.y + teammate.height/2 - game.ball.y, 2)
                        );
                        
                        if (dist < minDistance) {
                            minDistance = dist;
                            closestTeammate = teammate;
                        }
                    }
                });
                
                if (closestTeammate) {
                    // حساب زاوية التمرير
                    const targetX = closestTeammate.x + closestTeammate.width/2;
                    const targetY = closestTeammate.y + closestTeammate.height/2;
                    const angle = Math.atan2(
                        targetY - (player.y + player.height/2),
                        targetX - (player.x + player.width/2)
                    );
                    
                    // تطبيق القوة على الكرة (تمرير لطيف)
                    game.ball.dx = Math.cos(angle) * config.passSpeed;
                    game.ball.dy = Math.sin(angle) * config.passSpeed;
                    game.ball.lastTouch = player.team;
                    
                    playSound('pass');
                }
            }
        }
        
        // تأثيرات صوتية
        function playSound(type) {
            // في تطبيق حقيقي، يمكنك استخدام Howler.js أو Audio API
            console.log('Playing sound:', type);
        }
        
        // إعادة تعيين اللعبة
        function resetGame() {
            game.ball.x = game.field.center.x;
            game.ball.y = game.field.center.y;
            
            // سرعة عشوائية للكرة عند البدء
            const angle = Math.random() * Math.PI * 2;
            game.ball.dx = Math.cos(angle) * config.ballStartSpeed;
            game.ball.dy = Math.sin(angle) * config.ballStartSpeed;
            game.ball.lastTouch = null;
            
            // إعادة تعيين مواقع اللاعبين
            initPlayers();
        }
        
        // تأثير الهدف
        function showGoalEffect(color) {
            goalEffect.style.backgroundColor = color;
            goalEffect.style.opacity = 0.8;
            
            setTimeout(() => {
                goalEffect.style.opacity = 0;
            }, 500);
        }
        
        // تحديد سرعة الكرة
        function limitBallSpeed() {
            const speed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
            if (speed > config.maxBallSpeed) {
                game.ball.dx = (game.ball.dx / speed) * config.maxBallSpeed;
                game.ball.dy = (game.ball.dy / speed) * config.maxBallSpeed;
            }
        }
        
        // حركة اللاعبين الآليين
        function moveAIPlayers() {
            game.teams.forEach(team => {
                team.players.forEach((player, index) => {
                    if (!player.isControlled) {
                        // إذا كانت الكرة مع الفريق الآخر، عد إلى الموضع الدفاعي
                        if (game.ball.lastTouch !== null && game.ball.lastTouch !== player.team) {
                            const targetX = canvas.width / 2 - config.playerSize / 2 + 
                                (index - 1) * 60 * (player.team === 0 ? -1 : 1);
                            const targetY = player.team === 0 ? 
                                canvas.height - 100 - (index * 40) : 
                                60 + (index * 40);
                            
                            const dx = targetX - player.x;
                            const dy = targetY - player.y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            if (distance > 10) {
                                player.dx = (dx / distance) * player.speed * 0.7;
                                player.dy = (dy / distance) * player.speed * 0.7;
                            } else {
                                player.dx = 0;
                                player.dy = 0;
                            }
                        } 
                        // إذا كانت الكرة مع فريقه، حاول الوصول إليها
                        else {
                            const dx = game.ball.x - (player.x + player.width/2);
                            const dy = game.ball.y - (player.y + player.height/2);
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            if (distance > 50) {
                                player.dx = (dx / distance) * player.speed;
                                player.dy = (dy / distance) * player.speed;
                            } else {
                                player.dx = 0;
                                player.dy = 0;
                                
                                // إذا كان قريبًا من الكرة، قد يحاول التمرير
                                if (distance < 40 && Math.random() < 0.02) {
                                    passBall(player);
                                }
                            }
                        }
                    }
                });
            });
        }
        
        // انجذاب الكرة للاعبين القريبين
        function applyBallAttraction() {
            let closestPlayer = null;
            let minDistance = Infinity;
            
            // البحث عن أقرب لاعب
            game.teams.forEach(team => {
                team.players.forEach(player => {
                    const dx = game.ball.x - (player.x + player.width/2);
                    const dy = game.ball.y - (player.y + player.height/2);
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < config.attractionDistance && distance < minDistance) {
                        minDistance = distance;
                        closestPlayer = player;
                    }
                });
            });
            
            // تطبيق قوة الانجذاب إذا كان هناك لاعب قريب
            if (closestPlayer && minDistance > 20) {
                const dx = (closestPlayer.x + closestPlayer.width/2) - game.ball.x;
                const dy = (closestPlayer.y + closestPlayer.height/2) - game.ball.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // قوة الانجذاب تتناسب عكسيا مع المسافة
                const force = config.attractionForce * (1 - (distance / config.attractionDistance));
                
                game.ball.dx += dx / distance * force;
                game.ball.dy += dy / distance * force;
            }
        }
        
        // تحديث اللعبة
        function update(deltaTime) {
            // تحديث شحن الضربة للاعبين
            game.teams.forEach(team => {
                const player = team.players[team.controlledPlayer];
                if (player.isCharging && player.power < 100) {
                    player.power += deltaTime * 0.1;
                    if (player.power > 100) player.power = 100;
                }
            });
            
            // تحديث شريط القوة
            player1PowerFill.style.width = `${game.teams[0].players[game.teams[0].controlledPlayer].power}%`;
            player2PowerFill.style.width = `${game.teams[1].players[game.teams[1].controlledPlayer].power}%`;
            
            // حركة اللاعبين المتحكم بهم
            game.teams.forEach(team => {
                const player = team.players[team.controlledPlayer];
                player.dx = 0;
                player.dy = 0;
                
                if (game.keys[team.controls.left]) player.dx = -player.speed;
                if (game.keys[team.controls.right]) player.dx = player.speed;
                if (game.keys[team.controls.up]) player.dy = -player.speed;
                if (game.keys[team.controls.down]) player.dy = player.speed;
                
                // تحديث المواقع مع الحدود
                player.x += player.dx;
                player.y += player.dy;
                
                // حدود الفريق الأزرق (النصف السفلي)
                if (team === game.teams[0]) {
                    if (player.x < 0) player.x = 0;
                    if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
                    if (player.y < canvas.height / 2) player.y = canvas.height / 2;
                    if (player.y + player.height > canvas.height) player.y = canvas.height - player.height;
                }
                
                // حدود الفريق الأحمر (النصف العلوي)
                if (team === game.teams[1]) {
                    if (player.x < 0) player.x = 0;
                    if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
                    if (player.y < 0) player.y = 0;
                    if (player.y + player.height > canvas.height / 2) player.y = canvas.height / 2 - player.height;
                }
            });
            
            // حركة اللاعبين الآليين
            moveAIPlayers();
            
            // تحديث جميع اللاعبين
            game.teams.forEach(team => {
                team.players.forEach(player => {
                    player.x += player.dx;
                    player.y += player.dy;
                });
            });
            
            // انجذاب الكرة للاعبين القريبين
            if (Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy) < 10) {
                applyBallAttraction();
            }
            
            // حركة الكرة
            game.ball.x += game.ball.dx * (deltaTime / 16);
            game.ball.y += game.ball.dy * (deltaTime / 16);
            
            // احتكاك الكرة
            game.ball.dx *= config.friction;
            game.ball.dy *= config.friction;
            
            // إذا كانت سرعة الكرة بطيئة جدًا، توقف
            if (Math.abs(game.ball.dx) < 0.1) game.ball.dx = 0;
            if (Math.abs(game.ball.dy) < 0.1) game.ball.dy = 0;
            
            // ارتداد الكرة من الجدران (مع حدود الملعب)
            if (game.ball.x - game.ball.radius < game.field.padding) {
                game.ball.x = game.field.padding + game.ball.radius;
                game.ball.dx *= -config.bounceFriction;
                playSound('wall');
            }
            if (game.ball.x + game.ball.radius > canvas.width - game.field.padding) {
                game.ball.x = canvas.width - game.field.padding - game.ball.radius;
                game.ball.dx *= -config.bounceFriction;
                playSound('wall');
            }
            if (game.ball.y - game.ball.radius < game.field.padding) {
                game.ball.y = game.field.padding + game.ball.radius;
                game.ball.dy *= -config.bounceFriction;
                playSound('wall');
            }
            if (game.ball.y + game.ball.radius > canvas.height - game.field.padding) {
                game.ball.y = canvas.height - game.field.padding - game.ball.radius;
                game.ball.dy *= -config.bounceFriction;
                playSound('wall');
            }
            
            // ارتداد الكرة من اللاعبين
            game.teams.forEach(team => {
                team.players.forEach(player => {
                    if (
                        game.ball.x + game.ball.radius > player.x &&
                        game.ball.x - game.ball.radius < player.x + player.width &&
                        game.ball.y + game.ball.radius > player.y &&
                        game.ball.y - game.ball.radius < player.y + player.height
                    ) {
                        // حساب زاوية الارتداد
                        const angle = Math.atan2(
                            game.ball.y - (player.y + player.height / 2),
                            game.ball.x - (player.x + player.width / 2)
                        );
                        
                        // تطبيق القوة بناء على سرعة اللاعب
                        const playerSpeed = Math.sqrt(player.dx * player.dx + player.dy * player.dy);
                        const power = playerSpeed * 0.5 + 2;
                        
                        game.ball.dx = Math.cos(angle) * power;
                        game.ball.dy = Math.sin(angle) * power;
                        game.ball.lastTouch = player.team;
                        limitBallSpeed();
                        
                        playSound('hit');
                    }
                });
            });
            
            // التحقق من الأهداف
            game.goals.forEach((goal, index) => {
                if (
                    game.ball.x + game.ball.radius > goal.x &&
                    game.ball.x - game.ball.radius < goal.x + goal.width &&
                    game.ball.y + game.ball.radius > goal.y &&
                    game.ball.y - game.ball.radius < goal.y + goal.height
                ) {
                    // تسجيل الهدف
                    const scoringTeamIndex = index === 0 ? 1 : 0;
                    game.teams[scoringTeamIndex].score++;
                    scoreBoard.textContent = `${game.teams[0].score} - ${game.teams[1].score}`;
                    
                    // تأثير الهدف
                    showGoalEffect(goal.color);
                    playSound('goal');
                    
                    // إعادة تعيين اللعبة
                    setTimeout(resetGame, 1000);
                }
            });
        }
        
        // رسم اللعبة
        function draw() {
            // مسح الشاشة
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // رسم العشب
            drawGrass();
            
            // رسم الخطوط
            drawFieldLines();
            
            // رسم الأهداف
            drawGoals();
            
            // رسم اللاعبين
            game.teams.forEach(team => {
                team.players.forEach(player => {
                    drawPlayer(player);
                });
            });
            
            // رسم الكرة
            drawBall();
        }
        
        // رسم العشب
        function drawGrass() {
            // خلفية الملعب
            ctx.fillStyle = '#2ecc71';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // خطوط العشب
            ctx.strokeStyle = '#27ae60';
            ctx.lineWidth = 2;
            
            for (let i = 0; i < canvas.width; i += 30) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            for (let i = 0; i < canvas.height; i += 30) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
        }
        
        // رسم خطوط الملعب
        function drawFieldLines() {
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 3;
            
            // خطوط الحدود
            ctx.strokeRect(
                game.field.padding, 
                game.field.padding, 
                canvas.width - game.field.padding * 2, 
                canvas.height - game.field.padding * 2
            );
            
            // خط المنتصف
            ctx.beginPath();
            ctx.moveTo(game.field.padding, canvas.height / 2);
            ctx.lineTo(canvas.width - game.field.padding, canvas.height / 2);
            ctx.stroke();
            
            // دائرة المنتصف
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 2, game.field.centerCircleRadius, 0, Math.PI * 2);
            ctx.stroke();
            
            // نقطة المنتصف
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 2, 5, 0, Math.PI * 2);
            ctx.fillStyle = 'white';
            ctx.fill();
        }
        
        // رسم الأهداف
        function drawGoals() {
            game.goals.forEach(goal => {
                // الشباك
                ctx.fillStyle = goal.color;
                ctx.fillRect(goal.x, goal.y, goal.width, goal.height);
                
                // القوائم
                ctx.fillStyle = 'white';
                ctx.fillRect(goal.x - config.postWidth, goal.y, config.postWidth, goal.height * 3);
                ctx.fillRect(goal.x + goal.width, goal.y, config.postWidth, goal.height * 3);
            });
        }
        
        // رسم اللاعب
        function drawPlayer(player) {
            // الجسم
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);
            
            // تحديد إذا كان اللاعب المتحكم به
            if (player.isControlled) {
                ctx.strokeStyle = 'yellow';
                ctx.lineWidth = 2;
                ctx.strokeRect(player.x - 2, player.y - 2, player.width + 4, player.height + 4);
            }
            
            // العيون
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(
                player.x + player.width * 0.3,
                player.y + player.height * 0.4,
                player.width * 0.15,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(
                player.x + player.width * 0.7,
                player.y + player.height * 0.4,
                player.width * 0.15,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            // بؤبؤ العين
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(
                player.x + player.width * 0.3 + (player.dx * 0.2),
                player.y + player.height * 0.4 + (player.dy * 0.2),
                player.width * 0.07,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(
                player.x + player.width * 0.7 + (player.dx * 0.2),
                player.y + player.height * 0.4 + (player.dy * 0.2),
                player.width * 0.07,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            // الفم
            ctx.beginPath();
            ctx.arc(
                player.x + player.width * 0.5,
                player.y + player.height * 0.7,
                player.width * 0.2,
                0,
                Math.PI
            );
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
        
        // رسم الكرة
        function drawBall() {
            // الكرة الأساسية
            const gradient = ctx.createRadialGradient(
                game.ball.x - game.ball.radius * 0.3,
                game.ball.y - game.ball.radius * 0.3,
                0,
                game.ball.x,
                game.ball.y,
                game.ball.radius
            );
            gradient.addColorStop(0, '#f5f5f5');
            gradient.addColorStop(1, '#bdbdbd');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(game.ball.x, game.ball.y, game.ball.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // تفاصيل الكرة
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 1;
            
            // خطوط الكرة (نمط كرة القدم التقليدية)
            ctx.beginPath();
            ctx.arc(game.ball.x, game.ball.y, game.ball.radius, 0.2, Math.PI - 0.2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.arc(game.ball.x, game.ball.y, game.ball.radius, Math.PI + 0.2, Math.PI * 2 - 0.2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(
                game.ball.x + game.ball.radius * Math.cos(0.2),
                game.ball.y + game.ball.radius * Math.sin(0.2)
            );
            ctx.lineTo(
                game.ball.x + game.ball.radius * Math.cos(Math.PI + 0.2),
                game.ball.y + game.ball.radius * Math.sin(Math.PI + 0.2)
            );
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(
                game.ball.x + game.ball.radius * Math.cos(Math.PI/2 + 0.2),
                game.ball.y + game.ball.radius * Math.sin(Math.PI/2 + 0.2)
            );
            ctx.lineTo(
                game.ball.x + game.ball.radius * Math.cos(Math.PI*1.5 + 0.2),
                game.ball.y + game.ball.radius * Math.sin(Math.PI*1.5 + 0.2)
            );
            ctx.stroke();
        }
        
        // حلقة اللعبة الرئيسية
        function gameLoop(timestamp) {
            if (!lastTime) lastTime = timestamp;
            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;
            
            if (gameRunning) {
                update(deltaTime);
                draw();
                animationFrameId = requestAnimationFrame(gameLoop);
            }
        }
        
        // بدء اللعبة عند تحميل الصفحة
        window.addEventListener('load', () => {
            initPlayers();
            draw(); // رسم الشاشة الأولية
        });
    </script>
</body>
</html>
